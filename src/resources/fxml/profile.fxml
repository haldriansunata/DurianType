<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns:fx="http://javafx.com/fxml/1"
            xmlns="http://javafx.com/javafx/17"
            fx:controller="com.typingapp.controller.ProfileController"
            styleClass="root"
            minWidth="900"
            minHeight="520"
            prefWidth="1200"
            prefHeight="700">

    <padding>
        <Insets top="20" right="35" bottom="20" left="35"/>
    </padding>

    <!-- Top Section - GOLDEN TITLE + User Info -->
    <top>
        <VBox spacing="8" alignment="CENTER">
            <padding>
                <Insets bottom="12"/>
            </padding>
            
            <Label text="PROFILE &amp; SETTINGS" styleClass="header-label" style="-fx-font-size: 44px; -fx-text-fill: #FFD54F; -fx-font-weight: 900;"/>
            
            <HBox alignment="CENTER" spacing="16">
                <Label fx:id="usernameLabel" 
                       text="Username: Guest" 
                       styleClass="username-label" style="-fx-font-size: 16px;"/>
                <Label text="•" style="-fx-text-fill: #5C3A24; -fx-font-size: 16px;"/>
                <Label text="Logout →" 
                       onMouseClicked="#handleLogout" 
                       styleClass="nav-link-danger" 
                       style="-fx-cursor: hand; -fx-font-size: 14px;"/>
            </HBox>
        </VBox>
    </top>

    <!-- Center Content - HORIZONTAL LAYOUT -->
    <center>
        <HBox spacing="20" alignment="TOP_CENTER">
            <padding>
                <Insets top="5" right="5" bottom="5" left="5"/>
            </padding>
            
            <!-- LEFT - Update Profile Section (COMPACT) -->
            <VBox spacing="14" alignment="TOP_CENTER" minWidth="340" maxWidth="420" styleClass="card" style="-fx-padding: 20px;">
                
                <Label text="UPDATE PROFILE" styleClass="section-title" style="-fx-font-size: 18px; -fx-text-fill: #FFD54F; -fx-font-weight: 700;"/>
                
                <VBox spacing="12" alignment="CENTER">
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="New Username" prefWidth="115" minWidth="115" styleClass="form-label" style="-fx-font-size: 12px;"/>
                        <TextField fx:id="newUsernameField" 
                                   promptText="Enter new username" 
                                   prefWidth="200" style="-fx-font-size: 12px;" HBox.hgrow="ALWAYS"/>
                    </HBox>
                    
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="New Password" prefWidth="115" minWidth="115" styleClass="form-label" style="-fx-font-size: 12px;"/>
                        <PasswordField fx:id="newPasswordField" 
                                       promptText="Enter new password" 
                                       prefWidth="200" style="-fx-font-size: 12px;" HBox.hgrow="ALWAYS"/>
                    </HBox>
                    
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="Confirm Password" prefWidth="115" minWidth="115" styleClass="form-label" style="-fx-font-size: 12px;"/>
                        <PasswordField fx:id="confirmPasswordField" 
                                       promptText="Confirm new password" 
                                       prefWidth="200" style="-fx-font-size: 12px;" HBox.hgrow="ALWAYS"/>
                    </HBox>
                </VBox>
                
                <Button text="UPDATE PROFILE" 
                        onAction="#handleUpdateProfile" 
                        styleClass="button-primary" 
                        style="-fx-font-size: 13px;"
                        prefWidth="200"
                        minWidth="200"/>
            </VBox>

            <!-- RIGHT - Game History Section (WIDER) -->
            <VBox spacing="10" alignment="TOP_CENTER" HBox.hgrow="ALWAYS" minWidth="550" VBox.vgrow="ALWAYS" styleClass="card" style="-fx-padding: 18px;">
                <HBox alignment="CENTER" spacing="15">
                    <Label text="GAME HISTORY" styleClass="section-title" style="-fx-font-size: 18px; -fx-text-fill: #FFD54F; -fx-font-weight: 700;"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <!-- WIDER COMBOBOX -->
                    <ComboBox fx:id="historyLanguageCombo" prefWidth="130" minWidth="120" styleClass="combo-box" style="-fx-font-size: 12px;"/>
                </HBox>
                
                <TableView fx:id="historyTable" VBox.vgrow="ALWAYS" minHeight="200">
                    <columns>
                        <TableColumn fx:id="modeColumn" text="Mode" prefWidth="70" minWidth="60" styleClass="table-column-center"/>
                        <TableColumn fx:id="languageColumn" text="Language" prefWidth="80" minWidth="70" styleClass="table-column-center"/>
                        <TableColumn fx:id="wpmColumn" text="WPM" prefWidth="70" minWidth="60" styleClass="table-column-center"/>
                        <TableColumn fx:id="accuracyColumn" text="Accuracy" prefWidth="90" minWidth="80" styleClass="table-column-center"/>
                        <TableColumn fx:id="dateColumn" text="Date" prefWidth="180" minWidth="160" styleClass="table-column-center"/>
                    </columns>
                    <columnResizePolicy>
                        <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                    </columnResizePolicy>
                </TableView>
            </VBox>

        </HBox>
    </center>

    <!-- Bottom Section - Back to Menu + Danger Zone -->
    <bottom>
        <VBox spacing="8" alignment="CENTER">
            <padding>
                <Insets top="12" right="10" bottom="8" left="10"/>
            </padding>
            
            <!-- BACK TO MENU -->
            <Button text="← BACK TO MENU" 
                    onAction="#handleBackToMenu" 
                    styleClass="button-primary" 
                    style="-fx-font-size: 14px;"
                    prefWidth="220"
                    minWidth="200"/>
            
            <!-- THIN SEPARATOR -->
            <Separator prefWidth="500">
                <padding>
                    <Insets top="6" bottom="6"/>
                </padding>
            </Separator>
            
            <HBox alignment="CENTER" spacing="18">
                <Label text="Danger Zone:" style="-fx-font-size: 12px; -fx-text-fill: #D84315; -fx-font-weight: 600;"/>
                <Button text="DELETE ACCOUNT" 
                        onAction="#handleDeleteAccount" 
                        styleClass="button-danger"
                        style="-fx-font-size: 12px;"
                        prefWidth="180"
                        minWidth="180"/>
                <Label text="(Cannot be undone)" styleClass="info-label" style="-fx-font-size: 10px; -fx-text-fill: #8B7355;"/>
            </HBox>
        </VBox>
    </bottom>

</BorderPane>
